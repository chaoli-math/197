\section{非约态概形}

我们现在离开那些能被看作概形的对象，即那些仿射概形$\spec R$而$R$是有一个有限生成代数闭域上的代数，且没有幂零元。这里的现象将变得不再那么熟悉，我们需要在他们身上花费更多努力。

这类概形在一些足够简单的几何背景下就已经出现了：比如，下面处理的多重点已经作为两个寻常概形的相交或者作为映射“退化的”纤维出现了，正如Exercise \ref{exe.2.2}中看到的。另一类非约态概形重要的应用在一族簇的理论（theory of families of varieties）：形变理论（deformation theory）以及模理论（moduli theory）。我们将解释如何对一族单参数的簇取极限，以及引入关键概念，平坦性。最后，我们将给出一些非约态概形的例子，就它们自身而言都是有趣的对象。

从最简单的情况入手，我们将关注仿射空间$\mathbb{A}_K^n$的子概形，其支撑包含原点 ------ 等价地，它由一个理想$I$给出，其零点集$V(I)$作为集合包含$(0$, $\dots$, $0)$. （回忆一个概形的支撑是指它自有的那个拓扑空间。）

\subsection{双重点}
\index{双重!点}
\begin{exa}
	此类概形最简单的例子是$\mathbb{A}_K^1$由理想$(x^2)$定义的子概形 ------ 即概形$\spec K[x]/(x^2)$，通过商映射$K[x]\to K[x]/(x^2)$诱导的映射看作$\mathbb{A}_K^1$的子概形。这个概形只有一个点，对应于理想$(x)$，但同样作为$\mathbb{A}_K^1$的子概形与作为抽象概形，这与概形$\spec K[x]/(x)=\spec K$不同。作为抽象概形，我们能看到存在如下差别，在$X$上存在非零正则函数（比如$x$）在$X$唯一一点处为零，当然任意这样的函数平方为零。差别在于，作为$\mathbb{A}_K^1$的子概形，$\mathbb{A}_K^1$上的函数$f\in K[x]$在$X$上为零当且仅当$f$和它的一阶导数同时在点$0$为零。于是$X$上的函数包含两个数据，$\mathbb{A}_K^1$上的一个函数与它的一阶导数在点$0$的值。因为这个原因，有时我们将$X$叫做$\mathbb{A}_K^1$中点$0$的\textit{一阶邻域}\index{一阶!邻域}。
\end{exa}

更一般的，对于任意的$n$，理想$(x^n)$定义了一个子概形$X\subset \mathbb{A}_K^1$，它的坐标环为$K[x]/(x^n)$，$\mathbb{A}_K^1$上的函数$f(x)$在$X$上为零当且仅当$f$以及它的前$n-1$阶导数全都在点$0$处为零。

\begin{exa}[双重点]
理解双重点的下一步是考虑$\mathbb{A}_K^2=\spec K[x,y]$中其支撑包含原点的子概形，这个子概形需要同构于Example {{\addtocounter{thm}{-1}}\thethm{\addtocounter{thm}{1}}}中的那个子概形$X$. 令$Y\subset \mathbb{A}_K^2$是这样的一个子概形，$R=\mathscr{O}_Y(Y)\cong K[\varepsilon]/(\varepsilon^2)$是它的坐标环，以及满射
\[
	\varphi:K[x,y]\to R
\]
定义了$Y$到$\mathbb{A}_K^2$的含入。因为，$R$中唯一的极大理想$\mm$在$K[x,y]$中的原像是对应于原点的理想$(x,y)$，因为在$R$中$\mm^2=0$，于是映射$\varphi$在$(x,y)^2=(x^2,xy,y^2)$上为零，于是诱导了映射
\[
	\bar\varphi:K[x,y]/(x^2,xy,y^2)\to R.
\]
等价地，$Y$必须包含在子概形
\[
	\spec K[x,y]/(x^2,xy,y^2)
\]
中。但环$K[x,y]/(x^2,xy,y^2)$是一个$K$上的三维矢量空间，$R$只有二维。这是因为，$\varphi$的核将包含一个非零齐次线性型$\alpha x+\beta y$，其中$\alpha$, $\beta\in K$. 记
\[
	X_{\alpha,\beta}=\spec K[x,y]/(x^2,xy,y^2,\alpha x+\beta y)\hookrightarrow \mathbb{A}_K^2.
\]
子概形$X_{\alpha,\beta}$能被下面的条件所刻画：

\begin{enumerate}[{(i)}]\setlength{\itemsep}{0pt}
\item 关联于函数$f\in K[x,y]$的理想的$\mathbb{A}^2_K$子概形，在原点为零以及在那儿其偏导数满足
\[
	\beta\frac{\partial f}{\partial x}-\alpha\frac{\partial f}{\partial y}=0
\]
（因为这可以推出$f=c(\alpha x+\beta y)+$高阶项），或者
\item Example {{\addtocounter{thm}{-1}}\thethm{\addtocounter{thm}{1}}}中的子概形$X\subset \mathbb{A}_K^1$在$\mathbb{A}_K^1$到$\mathbb{A}_K^2$的含入映射下的像由$x\mapsto (\beta x,-\alpha x)$给出。
\end{enumerate}

经典语言下，子概形$X_{\alpha,\beta}$被称作包含点$(0,0)$以及一个在$\alpha x+\beta y=0$方向上“无穷接近的点”，我们下面在传统图像中以一个小箭头画出$X_{\alpha,\beta}$：

% \pic{6.png}

\noindent 这是打算用一个切空间的可区分的一维子空间在平面上来表示这个点（实际上没有可区分的切矢量，不管箭头的方向）。\nottran
\end{exa}

% \begin{wrapfigure}{i}{140pt}\includegraphics[scale=0.5]{chap_2/pics/7.png}\end{wrapfigure}
在实践中，概形$X_{\alpha,\beta}$会怎么出现呢？一种方式是曲线的相交。比如，当我们想要处理一条直线$L$与一条圆锥曲线$C$相切，显然，只在集合论意义上处理它们的相交是不令人满意的：
一条直线与一条圆锥曲线应该相交两次。甚至，说$C\cap L$的交点“重数为二”也不是完全令人满意的：比如，交点应该决定直线$L$，正如在非相切的例子中那般。真正令人满意的定义是，$C\cap L$是由理想$I_C$与理想$I_L$的和决定的$\mathbb{A}_K^2$的子概形，使得，比如，直线$y=0$以及抛物线$y=x^2$将相交于子概形$X_{0,1}=\spec K[x,y](x^2,y)$. 作为平面中唯一包含于$X_{0,1}$的直线，这将完全决定$L$. 

另一个形如$X_{\alpha,\beta}$的子概形出现的重要方式是作为可约概形的极限。比如，考虑平面上一对不同的点$(0,0)$与$(a,b)$，它们的并是闭子概形
\[
	X=\{(0,0),(a,b)\}=\spec S\subset \mathbb{A}_K^2,
\]
其中
\[
\begin{aligned}
	S&=K[x,y]/\left((x,y)\cap (x-a,y-b)\right)\\
	&=K[x,y]/(x^2-ax,xy-bx,xy-ay,y^2-by).
\end{aligned}
\]
由中国剩余定理，$S\cong K\times K$. 于是，特别地，$S$（作为矢量空间）是一个二维$K$-代数。

现在假设点$(a,b)$沿着一条曲线$(a(t),b(t))$往$(0,0)$移动，其中$(a(0),b(0))=(0,0)$而$a$, $b$是$t$的多项式，我们记作
\[
	a(t)=a_1t+a_2t^2+\dots,\quad b(t)=b_1t+b_2t^2+\dots.
\]

% \begin{center}\includegraphics[scale=0.5]{chap_2/pics/8.png}\end{center}

那么$X_t=\{(0,0),(a(t),b(t))\}$在$t\to 0$的极限是什么呢？使用概形，我们能采用一种不常见的观点，在如下的合适表述下，此时它的极限依然是两个点：它将是一个仿射概形$X$，其坐标环依然是一个$K$上的二维矢量空间。我们可以取$X$的理想$I$来定义$X$，而$X$的理想是下面这个理想在$t\to 0$下的极限
\[
	I_t=(x,y)\cap (x-a(t),y-b(t)).
\]
当然，这仅仅把困难转移到了描述什么是理想族的极限上！但这是简单的：在这个例子中，比如，我们能取它们的极限为$K[x,y]$
中，看作$K$上的矢量空间时，余维数为2的子空间。这个极限依然是一个理想因为乘法是连续的。在理想的余维数是无限时，一个更精巧的解释是必要的，我们将在遇到一维概形族的极限以及再一次在3.3.2节中的射影情况下讨论这个问题。

为了看看上面说的在实践中是什么意思，首先观察$I_t$生成元$x^2-a(t)x$, $xy-b(t)x$, $xy-a(t)y$以及$y^2-b(t)y$，它们当$t\to 0$的时候有清楚的极限$x^2$, $xy$, $xy$和$y^2$，于是这些多项式应该在$I$中。此外，观察$I(t)$包含线性型
\[
	a(t)y-b(t)x=(xy-b(t)x)-(xy-a(t)y),
\]
因此对$t\neq 0$，同样多项式
\[
	\frac{a(t)y-b(t)x}{t}=a_1y-b_1x+t(\dots)
\]
% \begin{wrapfigure}{i}{160pt}\includegraphics[scale=0.5]{chap_2/pics/9.png}\end{wrapfigure}
也在$I$中。于是，理想$I$同样也包含它的极限$a_1y-b_1x$. 但是上式右侧作为$K[x,y]$的子空间的余维数
已经是2了。于是$I=(x^2,xy,y^2,a_1y-b_1x)$，以及，相应地，
\[
	\lim_{t\to 0}(X_t)=X_{\alpha,\beta},
\]
其中$\alpha=b_1$以及$\beta=-a_1$.

从这个例子我们看到，$X$作为$\mathbb{A}_K^2$的子概形，“记住”了$(a(t),b(t))$趋向$(0,0)$的方向：我们认为它包含原点以及原点处沿着直线$a_1y-b_1x=0$的切方向。这条直线是连接$(0,0)$以及$(a(t),b(t))$的直线$L_t$的极限，这就是说，这是曲线被参数化为$(a(t),b(t))$后在原点处的切线，正如图所示。

我们将在\ref{s.2.3.4}节看到如何推广极限的概念。

\subsection{多重点}

上一个例子中的子概形$X_{\alpha,\beta}$被称为平面上的“双重点”，这里\textit{双重}\index{双重!点}指坐标环
\[
	R=K[x,y]/(x^2,xy,y^2,\alpha x+\beta y)\cong K[t]/(t^2)
\]
作为$K$-模的矢量空间维数。一般地，如果$X=\spec R$是一个仿射概形，以及$R$是一个$K$上的有限维矢量空间，我们定义$X$相对于$K$的\idx{度}\label{deg}（degree）为$R$作为$K$-矢量空间的维度，记作$\deg_K(X)$或者再简单些$\deg(X)$. （当对域$K$不会产生歧义的时候，我们将在记号和行文中去掉脚标$K$.） 在这种情况下，我们称$\spec R$是一个\textit{有限$K$-概形}。\index{有限!概形}

下面考虑度为3及以上的例子。一些东西在这里将变得不一样了。首先，代数闭域$K$上的所有双重点 ------ 即仿射概形$\spec R$，其中$R$是一个维度为2的局部$K$-代数 ------ 是同构的，因为这样的$R$必然同构于$K[x]/(x^2)$. （证明：令$\mm$是$R$的极大理想，因为$K$没有有限维扩张，于是$R/\mm\cong K$. 因为$R$是二维的，$\mm$是一维的，所以$\mm^2=0$（比如，从Nakayama引理可以得到这点\footnote{译者注：因为$\mm^2$作为$\mm$的子模，要么是一维的要么是$0$，如果是一维的，则$\mm=\mm^2$，此时由Nakayama引理，存在一个$a\in \mm$使得$am=m$对所有的$m\in \mm$都成立。注意到$\mm$是唯一的极大理想，所以$1-a$可逆，故$m=0$，这与$\mm$是一维的矛盾。}）。于是从$K[x]$到$R$的自然满射的核包含$x^2$，这样$R$与$K[x]/(x^2)$的同构就已经给出了。）作为对比，对于三重点（度为3的点）这点并不正确：概形
\[
	\spec K[x]/(x^3)\quad\text{和}\quad \spec K[x,y]/(x^2,xy,y^2)
\]
很轻松就可以看出是不同构的。然而，任意三重点同构于上面两者中的一个，这个事实的证明我们留作下面的习题。

\begin{exe}
	设$K$是一个代数闭域，而$K=\spec K[x_1,$ $\dots$, $x_n]/I\subset \mathbb{A}_K^n$是任意的度为3的零维子概形，且他的支撑包含原点。证明，$Z$同构于$X=\spec K[x]/(x^3)$或者
	\[
		Y=\spec K[x,y]/(x^2,xy,y^2),
	\]
	以及$X$与$Y$并不同构。
\end{exe}

特别地，任意的$K$-矢量空间维度为3的环$K[x_1,$ $\dots$, $x_n]/I$能被两个$x_i$的线性型生成。几何上来看，这就是说，$\mathbb{A}_K^n$中度为3的点是平面的，即，处于一个线性子空间$\mathbb{A}_K^2\subset \mathbb{A}_K^n$上。在$\mathbb{A}_K^2$中，以上两类三重点能被实现为三个不同的点的极限。同构于$X$的那一类，能被看作三个点都来自于同一条非奇异曲线，然而同构于$Y$的哪一类来自于当两个点以两个不同的方向趋向于第三个点。下面的练习包含了这个现象的例子。

\begin{exe}
	\begin{enumerate}[{(i)}]\setlength{\itemsep}{0pt}
		\item 证明，$\mathbb{A}_K^2$的由理想$(y-x^2,xy)$给出的子概形来自于在圆锥曲线$y=x^2$三个点的极限，这个子概形同构于上面的$X$，但是不包含$\mathbb{A}_K^2$的任意直线。

		% \pic{10.png}

		\item 证明，来自于当两个点以两个不同的方向趋向于第三个点极限的$\mathbb{A}_K^2$的子概形同构于上面的$Y$.
	\end{enumerate}
\end{exe}

\begin{exe} （对那些熟悉Grassmannian的人。）上面的例子可能让人觉得同构于$X$的概形是那些同构于$Y$的概形的极限。然而事实并不如人所愿，下面的例子与其刚好相反。令$\mathscr{H}$是$\mathbb{A}_K^2$中的度为3的有限子概形，其支撑包含原点。$\mathscr{H}$可以通过六维矢量空间$K[x,y]/(x,y)^3$的一个余维数为3的子空间的Grassmannian的闭子概形自然地参数化。证明$\mathscr{H}$是一个曲面，其中一点对应于唯一的子概形$\spec K[x,y]/(x^2,xy,y^2)$，它同构于$Y$，其余的点对应于同构于$X$的子概形。
\end{exe}

\begin{exe}
	令$C$是$\mathbb{A}_K^n$的由理想
	\[
	J=(x_2-x_1^2\text{, }x_3-x_1^3\text{, }\dots)
	\]
	给出的子概形。$C$中的一个闭点具有形式$f(t)=(t$, $t^2$, $t^3$, $\dots$, $f^n)$，其中$t\in K$，它有理想$(x_1-t$, $x_2-t^2$, $\dots)$. 考虑对$t\neq 0$的三点子概形
	\[
	X_t=\{f(0)\text{, }f(t)\text{, }f(2t)\}\subset C.
	\]

	\begin{enumerate}[{(a)}]\setlength{\itemsep}{0pt}
		\item 证明，当$t\to 0$时候概形$X_t$的极限是
		\[
		X_0=\spec K[x_1\text{, }\dots\text{, }x_n]/(x_2-x_1^2\text{, }x_1x_2\text{, }x_3\text{, }x_4\text{, }\dots\text{, }x_n),
		\]
		他同构于上面提到的三重点$\spec K[x]/(x^3)$.
		\item 证明，然而，$X_0$并不包含于$C$在原点的切线。而是，$X_0$包含的$\mathbb{A}_K^n$的最小线性子空间是$C$的密切平面
		\[
		x_3=x_4=\cdots=x_n=0,
		\]
		（回忆，按定义，这是切线以及$C$上原点附近其他点张成的平面在这些点趋向原点时的极限）\nottran，然而$C$的切线是$\mathbb{A}_K^n$的最小线性子空间包含$X_0$坐标环的极大理想的平方定义的子概形。于是，在这层意味上，$X_0$同时“记住”了$C$的切线与密切平面。
	\end{enumerate}
\end{exe}

\begin{exe}
	考虑对$t\neq 0$，子概形
	\[
	X_t=\{(0,0)\text{, }(t,0)\text{, }(0,t)\}\subset \mathbb{A}_K^2
	\]
	每个都包含了$\mathbb{A}_{K}^2$中三个不同的点。

	\begin{enumerate}[{(a)}]\setlength{\itemsep}{0pt}
		\item 证明，这族概形当$t\to 0$时的极限为
		\[
		X_0=\spec K[x,y]/(x^2,xy,y^2).
		\]
	\end{enumerate}
\end{exe}

\subsubsection*{度与重数}
\addcontentsline{toc}{subsubsection}{度与重数}

回忆在第\pageref{deg}页，我们定义了一个有限仿射$K$-概形$X=\spec R$的\textit{度}是$R$作为$K$-矢量空间的维度，其中$R$是有限维的。当$K$是代数闭的时候，这样一个概形$X$的度，从某种角度来说，度量了它的非约态的程度。然而，就像最后一个习题所展现的，在一般的情况下这并不是正确的：$\spec \cc$是约态的，但是作为$R$上的概形，它的度为2.

这里有另一个概念，称为重数（multiplicity），它度量了$X$非约态的程度。与度依赖于基域$K\subset R$选取不同，重数是$X$本身的不变量，它在更一般的情况下有定义 ------ 我们这里将在任意Krull维数为零局部环$R$（即任意Artin局部环）上定义它。

令$R$是任意的零维局部环，它的极大理想是$\mm$. 可以选取$R$的一列理想
\[
	R\supset \mm = I_1\supset I_2\supset \cdots \supset I_{l-1}\supset I_l=0
\]
使得每一个商$I_j/I_{j+1}$作为$R$-模同构于$R/\mm$. （比如，我们能从一个比较粗的列
\[
	R\supset \mm \supset \mm^2\supset \cdots \supset 0
\]
开始，然后不断选取任意$R/\mm$-矢量空间$\mm^j/\mm^{j+1}$的子空间来加细它。）尽管这样一条列不唯一，但是它的长度$l$确实与选取无关的，我们定义$l$为环$R$或者零维概形$X$的\textit{重数}或者\textit{长度}\index{长度!环的}\index{长度!概形的}（比如见Eisenbud [1995, Section 2.4]）。注意在原来的情况，当$R$是一个$K$上的有限维矢量空间时，剩余类域$R/\mm=\kappa$是$K$的一个有限扩张，所以我们有关系
\[
	\deg_K(X)=[\kappa:K]~\mathrm{mult}(X).
\]

对于任意的零维概形$X$，以及点$p\in X$，我们定义$X$在点$p$处的\textit{重数}为局部环$\mathscr{O}_{X,p}$的重数，记作$\mathrm{mult}_p(X)$. 如果$X$是一个有限$K$-概形，则$X$相对于$K$的度由
\[
	\deg_K(X)=\sum_{p\in X}[\kappa(p):K]~\mathrm{mult}_p(X)
\]
给出。

在第三章，我们将看到度和重数的概念如何拓展到正维数的概形上面去。

\subsection{嵌入点}

% \subsubsection*{准素分解}
% \addcontentsline{toc}{subsubsection}{准素分解}

\subsection{概形的平坦族}\label{s.2.3.4}

% \subsubsection*{极限}
% \addcontentsline{toc}{subsubsection}{极限}

% \subsubsection*{例子}
% \addcontentsline{toc}{subsubsection}{例子}

% \subsubsection*{平坦性}
% \addcontentsline{toc}{subsubsection}{平坦性}

% \subsection{多重直线}