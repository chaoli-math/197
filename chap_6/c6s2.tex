\section{用点函子刻画空间}\label{s:6.2}

描述一个有趣概形的点函子比起给出它的一个直接构造，不管是黏出来的还是
在仿射或射影空间中由方程显示给出来的，往往更容易且有时更有启发性。
典型的例子来自于Hilbert概形和其他模（moduli）问题，那里我们想要一个
自然的空间，其点表示了一些几何对象。但是，在讨论远简单的对象时，
这个观点同样有用，比如说纤维积或者射影空间本身。

在任何情况中，基本的想法是首先确定一个从概形范畴到集合范畴的函子，
然后证明一个存在性定理表明存在一个概形使得这个函子是点函子。当然，
为使这个程序可行，一个必要的组成部分的是一个局部（且容易检验的）判据
来证明这个函子可表，下面我们给出这样一个判据。

\subsection{概形间函子的刻画}\label{s:6.2.1}

为定义或构造首先作为函子的概形，我们遇到了一个基本的问题，即确定什么
时候一个函子是来自于一个概形。这里有一个刻画。

我们称$F:(\text{rings})\to (\text{sets})$是一个\textit{Zariski拓扑
上的层}，如果对任意的环$R$和$X=\spec R$的任意基本开集的开覆盖
$U_i=\spec R_{f_i}$，函子$F$满足开覆盖$\bigcup U_i=X$的层公理。
即，对任意一族元素$\alpha_i\in F(R_{f_i})$，$\alpha_i$和$\alpha_j$
都映射到$F(R_{f_if_j})$中的相同元素，则存在唯一的$\alpha\in F(R)$使得
它映射到每个$F(R_{f_i})$中为$\alpha_i$.

在实操中，这是一个相当容易检验的性质。实际上，这也足够保证$F$来自于
一个概形，若我们已经知道$F$在如下意义下被仿射概形所覆盖。
读者可以证明如下定理。

\begin{thm}\label{thm:6.14}
函子$F:(\textrm{ring})\to (\textrm{sets})$具有形式$h_Y$，其中$Y$是一个
概形，当且仅当
\begin{compactenum}[(1)]
\item $F$是Zariski拓扑下的层，以及
\item 存在环$R_i$以及开子函子
\[
    \alpha_i:h_{R_i}\to F
\]
使得，对任意的域$K$，$F(K)$是$h_{R_i}(K)$在映射$\alpha_i$下的像的并。
\end{compactenum}
\end{thm}

% p.260

一个简单的应用，我们可以用这个定理来证明纤维积的存在性。在概形范畴中
纤维积的构造，其已在第 \ref{chap:1} 章中阐述，是具有基本性意义的，
但这同时出乎意料地笨拙。使用函子的视角，我们至少可以通过给出其点函子
来描述两个概形的纤维积。若$X\to S$和$Y\to S$是两个概形间的态射，纤维积
$X\times_S Y$可以确定为其点函子为函子的纤维积$h_X\times_{h_S} h_Y$
的概形。而存在性建立于如下习题。

\begin{exe}\label{exe:6.15}
\begin{compactenum}[(a)]
\item 证明，若$f:A\to C$和$g:B\to C$是函子同态，且函子都是Zariski拓扑
    上的层，则纤维积$A\times_C B$也是Zariski拓扑上的层。
\item 用第 \ref{chap:1} 章中所建议的纤维积的开覆盖以及上面的定理来证明
    概形范畴中纤维积的存在性。
\end{compactenum}
\end{exe}

下面的例子给出了到射影空间的映射的另一种看法。Theorem \ref{thm:3.37}
可以直接翻译为我们的新语言：

\begin{thm}\label{thm:6.16}
若$Y=\mathbb P_{\mathbb Z}^n$，则
\begin{align*}
h_Y(X)=&
\;\{\text{局部为秩$n$直和项的局部自由子层$\mathscr F\subset 
\mathscr O_X^{n+1}$}\}\\
=&\; \frac{\{\text{$X$上的可逆层$P$，连同一个满态射$\mathscr O_X^{n+1}
\to P$}\}}{\{\text{同构}\}},
\end{align*}
其中同构定义同Corollary \ref{coro:3.42} 中那样。
\end{thm}

作为应用，我们将到射影空间的映射的这个描述与在第 \ref{s:6.1.3} 节描述
的作为$\spec K[\varepsilon]/(\varepsilon^2)$到$X$的映射的$X$上的切矢量
相结合，来计算$\mathbb P_K^n$在$K$-值点上的Zariksi切空间。由我们曾曰，
一个$\mathbb P_K^n$的$K$-值点是一个秩$n$的直和项$F\subset K^{n+1}$，
令$L$是商$L=K^{n+1}/F$. 在这个点的切空间$T$就是所有直和项$F'\subset 
(K[\varepsilon]/(\varepsilon)^2)^{n+1}$，它们模掉$\varepsilon$后是$F$.
我们断言，存在一个自然同构
\[
T\cong \Hom_K(F,L).   
\]
为得之，选一个分解$K^{n+1}=F\oplus L$，一个$F$的一组基$e_i$. 
任何$(K[\varepsilon]/(\varepsilon)^2)^{n+1}$的直和项$F'$模掉
$\varepsilon$后可以得到$F$，有一组基形如
$\{e_i+\varepsilon s_i+\varepsilon t_i\}$，其中$s_i\in F$, $t_i\in L$.
我们对$K'$定义一个映射$\alpha:F\to L$将$e_i$映为$t_i$. 反之，给定任意
映射$\alpha$，我们可以定义$F'$为由元素$e_i+\varepsilon\alpha(e_i)$
张成的模。

\begin{exe}\label{exe:6.17}
证明这些定义都不依赖于选取。
\end{exe}

最后，Theorem \ref{thm:6.14} 同样可用来从函子描述证明 Grassmannian
概形的存在性。

% p.261
\begin{exe}\label{exe:6.18}
对$0<k<n$，令
\[
g=g(k,n):(\text{rings})\to (\text{sets})    
\]
为Grassmannian函子，即，由
\[
    g(T)=\{\text{$T^n$的秩$k$直和项}\}
\]
给出的函子。证明这是射影空间$\mathbb P_{\mathbb Z}^r$的闭子概形
$G_{\mathbb Z}(k,n)$的点函子，如下。

首先，令$r= {n \choose k}-1$，令$\mathbb P_{\mathbb Z}^r
=\proj \mathbb Z[\dots X_I \dots]$为齐次坐标为$X_I$的射影空间，指标
对应为$\{1,2,\dots,n\}$的长度为$n-k$的子集。通过将直和项$M\subset T^n$
映到$\bigwedge^k M\subset \bigwedge^k T^n$定义一个自然变换
$g\to h_{\mathbb P_{\mathbb Z}^r}$. 用寻常的仿射开子概形
$U_I\cong \mathbb A_{\mathbb Z}^r$来覆盖$\mathbb P_{\mathbb Z}^r$，
证明这些子概形有下面的子函子来表示
\[
    U_I(T)=\{\text{$T^{r+1}$的秩$r$直和项使得$T^{r+1}$的第$I$个基矢量
    生成了余核}\},
\]
以及$U_I$和$g$的交（纤维积）为函子
\[
    (U_I\cap g)(T)=\{\text{$T^{n}$的秩$r$直和项$M$使得$T^{n}$的基矢量
    $e_{i_1},\dots,e_{i_{n-k}}$生成了余核}\}.
\]
验证交$U_I\cap g$可以由一个仿射概形表示。证明$g$是Zariski拓扑上的层，
然后推出$g$由一个概形所表示。
\end{exe}

此外，注意到我们并没有$g(T)=\bigcup (U_I\cap g)(T)$，除了在局部环上。

\begin{exe}\label{exe:6.19}
证明，这样给出的Grassmannian的定义与之前在第 \ref{s:3.2.7} 节给出的
定义相同。
\end{exe}

\begin{exe}\label{exe:6.20}
    对一个域$K$，给出Grassmannnian $G_K(k,n)$类似的定义，然后证明
    这与积$G_{\mathbb Z}(k,n)\times \spec K$相同。
\end{exe}

我们将在下节中看到这个定理的其他应用。函子观点在Damazure\& Grabriel
[1970]中有被深入细致发展，感兴趣的读者可以参考。

Grothendieck在概形上的工作的一个主要目标是通过不强且一般的性质，它们
常容易被验证，来找到一个概形函子的刻画，然后推出许多代数几何中的
存在性定理（就像同伦范畴中的Brown定理，见Spanier [1966, Chapter 7.7]）。
一开始，这个程序似乎看上去完全失败了，概形函子确实非常特殊，
比如见Hironaka [1962]. 然而，Artin发现了一个意想不到的近似定理，其表明%
% p.262
了有一个仅仅比概形函子范畴“大一点”的函子$\mathscr F$的范畴，它可以被
不强且一般的性质所刻画。几何地，函子$\mathscr F$就像将仿射概形
通过“\'etale等价关系”分开然后黏起来得到的空间。他将其叫做
\emph{代数空间}（一个它们会出现的典型场景，见第 \ref{s:6.2.4} 节）。
细节可见Artin [1971]和Knutson [1971].

\subsection{参数空间}\label{s:6.2.2}

\paragraph*{Hilbert概形}
\addcontentsline{toc}{subsubsection}{Hilbert概形}

点函子的概念产生最大影响的一个领域可能是参数空间的构成和描述。我们已经
在第 \ref{s:3.3.3} 节看到，比如，域$K$上射影空间的具有给定Hilbert多项
式$P$的子概形构成一个概形，我们将其叫做$\mathscr H_P$. 这样一个命题并
没有歧异看上去是有点惊奇的。尽管这些对象的\emph{集合}可能构成一个簇的
一些点是符合直觉的，难道它们不能以不同的方式构成簇吗？那它们又以
什么意义构成一个概形？

答案将通过明确我们希望子概形集合与$\mathscr H_P$的点的集合之间的对应关
系的性质而获得。具体地，注意到如果$\mathscr X\subset \mathbb P_K^n
\times B\to B$是任意$\mathbb P_K^n$的平坦子概形族，具有Hilbert多项式
$P$，我们得到了一个从$B$剩余类域为$K$的点的集合到$\mathscr H_P$的点的
集合的映射，其将$b\in B$映射到$\mathscr H_P$中对应%
\footnote{译者注：原文是``..., sending a point 
$b\in B$ to the point of $\mathscr H_P$ corresponding to the fiber
$X_b$ of $\mathscr H_P$ over $b$.'' 这里第二个$\mathscr H_P$应该是一个
笔误，实为$\mathscr X$.}%
$\mathscr X$在$b$处的纤维$X_b$的点。
自然，我们会问，这个映射是否来自于一个正则映射$B\to \mathscr H_P$？
再进一小步，我们希望$\mathscr H_P$具有如下性质，对任意$K$上的概形$B$，
由$B$所参数化的具有Hilbert多项式$P$的$\mathbb P_K^n$的平坦子概形族的
集合，可以自然等同于所有从$B$到$\mathscr H_P$的映射的集合。最后，因为
如何参数化具有给定Hilbert多项式的$\mathbb P_K^n$的子概形族的问题某种
程度上对所有$K$都相同，我们想要在$\spec \mathbb Z$上做这件事，即
（就在像Grassmannian的情况中那样，实际上这是一个Hilbert概形的特殊情况）
对每个$P$在$\spec \mathbb Z$上定义一个对象$\mathscr H_P$使得对任意的
$K$，积$\mathscr H_P\times \spec K$参数化了$\mathbb P_K^n$的具有Hilbert
多项式$P$的子概形族。

稍微说得不一样些，我们定义：

\begin{defi}\label{defi:6.21}
\emph{Hilbert函子}$h_P$，叫做“具有Hilbert多项式$P$的
$\mathbb P_{\mathbb Z}^n$中的概形平坦族的函子”，为函子
\[
    h_P:(\text{scheme})^\circ \to (\text{sets}),
\]
其对任意$B$给出了一个在$B$上平坦的子概形$\mathscr X\subset \mathbb P_B^n$
的集合，其在$B$上的点处的纤维具有Hilbert多项式$P$.
\end{defi}

我们接着想要取Hilbert概形$\mathscr H_P$为表示了$h_P$的概形：换句话说，
点函子为$h_P$的概形。由Yoneda引理 \eqref{lem:6.1}，这确定了概形
$\mathscr H_P$，如果其存在，因此核心定理如下：

% p.263

\begin{thm}\label{thm:6.22}
存在一个概形$\mathscr H_P$，其点函子为函子$h_P$.
\end{thm}

注意到，对任意概形$S$，我们可以在$S$-概形范畴类似定义函子
$h_{P,S}:(\text{$S$-schemes})^\circ \to (\text{sets})$，且如果
$\mathscr H_P$为表示了上面函子$h_P$的概形，则$h_{P,S}$是由$S$-概形
$\mathscr H_P\times S$所表的函子。

实际上，$\mathscr H_P\times \spec K$确实经常是一个概形，但\emph{并不是}
一个簇。我们将从 Exercise \ref{exe:6.35} 到 \ref{exe:6.37} 描述
Mumford [1962]的一个Hilbert概形的经典例子，其甚至在对应非奇异不可约
射影簇的点处都是非约态的。

Theorem \ref{thm:6.22} 有另一个经常用的诠释：称函子$h_P$可表等价于说
存在一个\emph{万有族}，即一个概形$\mathscr H$和一个在$\mathscr H$上平坦
的、具有Hilbert多项式$P$的子概形$\mathscr X\subset \mathbb 
P_{\mathbb Z}^n\times \mathscr H$，使得任意在$B$上平坦的具有Hilbert
多项式$P$的子概形$Y\subset \mathbb P_{\mathbb Z}^n\times B$等于
$Y=\mathscr X\times_{\mathscr H}B\subset \mathbb P_{\mathbb Z}^n\times B$
和一个唯一的态射$B\to \mathscr H$的纤维积。显然，如果一个万有族
$\mathscr X\subset \mathbb P_{\mathbb Z}^n\times \mathscr H$存在，
则$\mathscr H$表示了函子$h_P$. 反过来，如果一个概形$\mathscr H$表示了
$h_P$，则对应于恒等映射的
子概形$\mathscr X\subset \mathbb P_{\mathbb Z}^n \times \mathscr H$
为上面意义下的万有族。

我们将不会给出Theorem \ref{thm:6.22} 的证明，但是会指出如何处理，
更多的细节我们推荐读者去读Mumford [1966] 或者 Koll\'ar [1996].

想法是容易总结的：首先约化到射影空间$\mathbb P_B^n$的子概形$X$
的情况，这里基具有形式$B=\spec R$，而$R$是一个局部环。这样一个概形
$X$由其理想$I(X)\subset S=R[X_0,\dots,X_n]$确定，于是对足够大的$m$
（某种程度上仅依赖$P$），其被其次数为$m$的分量$I(X)_m\subset S_m$
确定。置$M={{m+n}\choose n}$和$q=P(m)$，它们对应了Grassmannian
$G_B(q,M)$中的一个点，这个Grassmannian参数了自由$R$-模$S_m\cong R^M$
中余维数为$P(m)$的直和项。这样，$\mathscr H_{P,B}$变成了这样平面的
Grassmannian $G_B(q,M)$的一个子概形。

关键在于，我们可以选一个统一的$m$使得对Hilbert多项式为$P$的任意子概形
$X$都有如下性质成立：存在一个$m_0$使得$m\geq m_0$且$X$是$\mathbb P_K^n$
的Hilbert多项式为$P$的子概形时，$I(X)_{l\geq m}$是由$I(X)_m$所生成的，
且$I(X)_m$在$S_m$里的余维数为$P_X(m)$. 审查我们的证明，
因为Hilbet多项式是一个多项式，我们看到只要证明
$I(X)$的极小自由分解中的自由模的生成元的次数可以被$X$的Hilbert多项式
所限制就够了。这由$X$的\emph{Castelnuovo正规化}所完成，更加完整的描述
将带我们离开太远。

% p.264

因此，对任意的基$B=\spec R$上的平坦族$\mathscr X\subset \mathbb P_B^n$，
即一个$h_P(\spec R)$中的元素，我们有一个$R^M$中余维数为$q$的直和项，即
一个$g(q,M)(R)$中的元素，其中$g=g(q,M)$是在Exercise \ref{exe:6.18} 中
所定义的Grassmannian函子。这个对应可以推广为一个从$h_P^*$到$g(q,M)$的
自然变换，其中$h_P^*:(\text{rings})\to (\text{sets})$为函子$h_P^*=
h_P(\spec R)$，于是也推广为一个从Hilbert函子$h_P$到由Grassmannian
$G=G_{\mathbb Z}(q,M)$所表的函子的自然变换。

未完成论证，我们必须证明，存在一个子概形$\mathscr H_P\subset G$使得
态射$\varphi:B\to G$以这种方式来源于一个具有Hilbert多项式$P$的平坦族
$\mathscr X\subset \mathbb P_B^n$，当且仅当$\varphi$经由$\mathscr H_P$
分解。这里，我们将满足于描述$\mathscr H_P$，作为$G$的一个闭子概形，的
方程。令$\mathscr Y$为$G$上的万有子丛。我们将有一个乘法映射：
\[
    \operatorname{mult}_{k}: \mathscr{Y} \otimes S_{k} \to S_{k+m},
\]
其中$S=\mathbb Z[X_0,\dots,X_n]$，以及我们可以取$\mathscr H_P$为
$G_{\mathbb Z}(q,M)$的由 
\[
    \operatorname{rank}(\operatorname{mult}_{k}) \leq \dim S_{k+m}-P(m+k)
\]
对所有$k\geq 0$都成立所定义的“行列式”子丛。

瞬间就可以知道，想要的映射$\varphi$都经由该子概形所分解。
给定这个子概形中的任何点$p$，证明（因为$m$可以选得足够大），由$S_m$的
相应线性子空间生成的理想定义了一个具有Hilbert多项式$P$的概形。
这为我们提供了一个具有Hilbert多项式$P$的概形们的$\mathscr H_P$上的
“重言族”。给定概形$B$到$\mathscr H_P$的任何映射，
可以使用纤维积来“拉回”该族得到一个$B$上的族，并且将映射$\varphi$与
该族对应。一旦所有这些都得到验证，对$\mathscr H_P$的点函子的描述就可以
确保$\mathscr H_P$不依赖于$m$的选择。

\paragraph*{Hilbert概形的例子}
\addcontentsline{toc}{subsubsection}{Hilbert概形的例子}
我们将主要以习题的形式来提到一些Hilbert概形的例子。首先，Grassmannian
$\mathbb G_S(k,n)$是一个Hilbert概形：它参数化了射影空间$\mathbb P_S^n$
中维数为$k$且次数为$1$的子概形。下面的习题处理了其中最简单的情况，
一般的命题（和证明）只在数值上有一些改动。

\begin{exe}\label{exe:6.23}
令$P(m)=m+1$为一条直线的Hilbert多项式。证明，$\mathbb P_{\mathbb Z}^3$
中具有Hilbert多项式$P$的子概形的Hilbert概形为在Exercise \ref{exe:6.20}
中所引入的Grassmannian.
\end{exe}

另一个直接的例子是超曲面。这是一个标准的观察，域$K$上射影空间
$\mathbb P_K^n$中次数为$d$的超曲面的集合可以等同于$n+1$个变量下的$d$-次
齐次多项式的集合。实际上，这个射影空间变成了这样的超曲面的Hilbert概形。
同上面的例子，下面的习题处理了一个典型的例子。

% p.265

\begin{exe}\label{exe:6.24}
令$P(m)=2m+1$为一条二次曲线的Hilbert多项式。证明$\mathbb P_{\mathbb Z}^2$
中具有Hilbert多项式$P$的子概形的Hilbert多项式$\mathscr H_P$为
$\mathbb P_{\mathbb Z}^5$.
\end{exe}

这些例子外，Hilbert概形的几何的了解并没有那么多。甚至，参数化了
域上的射影空间$\mathbb P_K^n$中的零维子概形的Hilbert多项式仍然神秘：
比如，Iarrobino [1985] 证明了（除去一些\naive 的例外），
这样的Hilbert概形一般不是不可约的。在$\mathbb P_K^2$的情况，这里
它们实际是不可约且非奇异的，但是它们的整体几何展示了许多问题：
比如可见Collino [1988]. 一个在这里我们可以给出描述的例子是下面的习题。

\begin{exe}\label{exe:6.25}
令$P$是一个常多项式$2$. 证明参数化了$\mathbb P_{\mathbb Z}^2$中具有
Hilbert多项式$P$的子概形的Hilbert多项式$\mathscr H_P$可以通过沿着
对角线爆破$\mathbb P_{\mathbb Z}^2\times \mathbb P_{\mathbb Z}^2$，
然后通过取交换因子的对合的商得到。\nottran
\end{exe}

一般情况中，我们关于Hilbert概形的知识非常少。比如，域$K$上的
射影空间$\mathbb P_K^3$中的曲线的情况，这是参数了纯正维数但不是
超曲面的概形的Hilbert概形的最简单的例子，我们甚至对$\mathscr H_P$
的分支的数量、维数、光滑性或奇异性都没有一个猜测。对这个例子的一个
讨论，见Harris \& Eisenbud [1982].

\paragraph*{Hilbert概形构造的一些变化}
\addcontentsline{toc}{subsubsection}{Hilbert概形构造的一些变化}
我们已经定义了参数化射影空间中具有给定Hilbert多项式$P$的子概形的
Hilbert概形。实际上，无需太多气力，我们就可以大幅推广它。

首先，我们注意到，如果$X\subset \mathbb P_S^n$是任意的闭子概形，我们
可以定义一个函子
\[
    h_{P,X}:(\text{$S$-schemes})^\circ \to (\text{sets})    
\]
将任意的$S$-概形$B$映到$X$中具有Hilbert多项式$P$的子概形族的集合，即
\[
    h_{P,X}(B)=\{\mathscr{X} \subset B \times_{S} X \subset B 
    \times_{S} \mathbb{P}_{S}^{n}=\mathbb{P}_{B}^{n}, 
    \text{ 在$B$上平坦，且具有Hilbert多项式$P$}
    \}.
\]

不难建立的关键事实如下：

\begin{exe}\label{exe:6.26}
证明$h_{P,X}$为$h_P$的一个闭子概形。
\end{exe}

% p.266

从中可知，存在一个闭子概形$\mathscr H_{P,X}\subset \mathscr H_P$其
点函子为$h_{P,X}$，此概形我们称为\emph{$X$的具有Hilbert多项式$P$的子
概形的Hilbert概形}。

作为一个重要的例子，如果我们取$P(m)={{k+m}\choose k}$为一个$k$-平面的
Hilbert多项式，我们将在下面的第 \ref{s:6.2.3} 节中看到，得到的概形
$\mathscr H_{P,X}$即$X$上$k$-平面的Fano概形，其定义在第 \ref{s:4.3} 节。 
这也不是一个空洞的观察：除了给出更自然的定义之外，Fano概形的这种刻画
将使我们能够确定它们的切空间。

现在，假设我们有两个射影$S$-概形$X\subset \P_S^m$和$Y\subset \P_S^n$.
我们可以将积$X\times_S Y$通过Segre映射
\[
X\times_S Y\hookrightarrow \P_S^m\times_S \P_S^n\hookrightarrow \P_S^N
\]
嵌入到射影空间中，其中$N=(m+1)(n+1)-1$. 因此，我们有参数化了积
$X\times_S Y$的Hilbert概形。

进而，这允许我们参数化从$X$到$Y$的映射，通过考虑它们作为积的子概形的
图像。我们需要检查两件事情
\begin{compactenum}[(1)]
\item 子概形$Z\subset X\times_S Y$上使得投影映射$\pi_X:Z\to X$为同构
      的条件在$X\times_S Y$的子概形的Hilbert概形上是一个开放的条件。
\item 有界射影次数的映射$\varphi:X\to Y$的图像$\Gamma_\varphi$的
      Hilbert多项式有界。（“射影次数”的定义见Harris [1995].）
\end{compactenum}

有了这个，我们看到，存在拟射影概形参数化了从$X$到$Y$的给定次数的态射，
以及类似地一个拟射影概形$\operatorname{Isom}(X,Y)$参数化了从$X$到$Y$
的同构。再，“参数化”我们指表示了由
\[
    \operatorname{isom}_{X, Y}(B)=
    \{\text{$B$-概形同构
        $\varphi: B \times_{S} X \rightarrow B \times_{S} Y$}\}
\]
给出的函子
\[
    \operatorname{isom}_{X, Y}:(\text{$S$-schemes})^{\circ} 
    \longrightarrow(\text{sets}).
\]

我们再提一个Hilbert概形的构造的推广，其在实际中非常实用。它叫
\emph{相对Hilbert概形}，其参数化了概形的平坦族的元素的子概形。

为此，令$S$为域$K$上的概形，并假设$X\subset \P_S^n$为任意在$S$上平坦的
概形。进而我们可以考虑函子
\[
h_{P,X/S}:(\text{$K$-schemes})^\circ \longrightarrow (\text{sets}),   
\]
其将任意$K$-概形$B$对应为$B$上的$X$在$S$上的纤维的平坦子概形族的集合，
即
\[
h_{P,X/S}(B)=\left\{\parbox{22em}{\begin{center}
        偶对$(\nu,\Sigma)$，其中$\nu:B\to S$和
        $\Sigma\subset B\times_S X\subset \P_B^n$在
        $B$上平坦且具有Hilbert多项式$P$
    \end{center}}\right\}.
\]
再，我们可以改写我们的基本构造来证明$h_{P,X/S}(B)$由一个$K$-概形
$\mathscr H_{P,X/S}$来表示。

最后，我们可以应用相对Hilbert概形构造到一对平坦族上来参数两个族的元素
间的态射！因此，如果$X\to S$和$Y\to S$为平坦族，我们有一个拟射影概形
$\operatorname{Mor}_{d,X/S,Y/S}$参数化了从$X$在$S$上的纤维到
$Y\to S$上对应纤维的给定次数的态射，以及类似地，一个参数化了同构的
概形。进而我们可以考虑函子

注意到，如果$X\to S$和$Y\to T$为可能具有不同基的族，我们可以参数化
从$X/S$的纤维到$Y/T$的纤维的态射，通过将这两个族同时拉回到积$S\times T$
以及应用那上面的构造。

作为这个构造的应用，我们有：

\begin{exe}\label{exe:6.27}
给定两个整数$g,h\geq 2$. 证明存在一个整数$N(g,h)$使得对于任意两个非奇异
曲线$C$和$C'$，它们亏格的分别是$g$和$h$，从$C$到$C'$的映射的数量小于
$N(g,h)$.
\end{exe}

更一般地：

\begin{exe}\label{exe:6.28}
    令$X\subset \P_S^m$和$Y\subset \P_T^n$为在$K$-概形$S$和$T$上平坦的
    概形，并假设对任意闭点$s\in S$和$t\in T$，在对应纤维$X_s$和$Y_t$间
    次数为$d$的态射的个数$n_d(s,t)$是有限的。证明，对给定的$d$，
    $n_d(s,t)$随着$s$和$t$变化，但确实有界的。
\end{exe}

\subsection{用点函子表示的切空间}\label{s:6.2.3}

\paragraph*{Hilbert概形的切空间}
\addcontentsline{toc}{subsubsection}{Hilbert概形的切空间}
Hilbert概形的最好由其点函子刻画的一面是它在一点处的切空间。我们首先
引入一阶形变的概念：如果$Y$是任意的概形，而$X\subset Y$是一个闭子概形，
一个\emph{$X$在$Y$中的一阶形变}被定义为一个平坦族$\mathscr X\subset 
Y\times \spec K[\varepsilon]/(\varepsilon^2)$使得$\mathscr X$在约态点
$\spec K\subset \spec K[\varepsilon]/(\varepsilon^2)$处的纤维为$X$.
于是，通过在第 \ref{s:6.1.3} 节中所刻画的概形的切矢量，则
\emph{Hilbert概形$\mathscr H_P$在一点$[X]$处的切空间为$X$的在
$\P_K^n$中的一阶形变的空间}；以及更一般地，如果$Y\subset \P_K^n$是一个
射影概形，则Hilbert概形$\mathscr H_P^Y$在点$[X]$处的切空间就是$X$在
$Y$中的一阶形变的空间。

这个描述异常有用，因为经常一阶形变的空间是可以被计算的，即使在我们
没有希望写下$\mathscr H_P$的方程的情况下。为此，我们对概形$Y$的闭子概形
$X$引入\emph{法层}$\mathscr N_{X/Y}$
\[
    \mathscr N_{X/Y}=\Hom_{\oo_X}(\mathscr I/\mathscr I^2,\oo_X)
    =\Hom_{\oo_Y}(\mathscr I,\oo_X)
\]
其中$\mathscr I=\mathscr I_{X/Y}$为$X$在$Y$中的理想层。接着我们有
下面的基本定理。

\begin{thm}\label{thm:6.29}
给定概形$Y$的一个闭子概形$X$，$X$在$Y$中的一阶形变的空间为其法层
$\mathscr N_{X/Y}$的整体截面的空间。
\end{thm}

\begin{proof}
首先，令$\mathscr X\subset Y\times \spec K[\varepsilon]/(\varepsilon^2)$
为与纤维$Y\cong Y\times \spec K\subset Y\times 
\spec K[\varepsilon]/(\varepsilon^2)$的交为$X$的任意子概形（并不需要
$\mathscr X$为平坦的）。令$U\subset Y$为任意仿射开子集，$V=X\cap U$
为相应的$X$中的仿射开集，以及$\mathscr V=\mathscr X\cap (U\times \spec 
K[\varepsilon]/(\varepsilon^2))$. 令$A=\oo_Y(U)$为$U$的坐标环，而
$I=I(V)$为$V$在$A$中的理想，于是层$\mathscr N_{X/Y}$在$V$上的限制为
$A$-模$\Hom(I,A/I)$的相伴层。

$U\times \spec K[\varepsilon]/(\varepsilon^2)$的坐标环为$A\otimes 
K[\varepsilon]/(\varepsilon^2)$，我们记这个环的一个元素为
$f+\varepsilon g$，其中$f$, $g\in A(U)$. 特别地，我们可以记
$\mathscr V$的理想$I(\mathscr V)$为
\[
    I(\mathscr{V})=\left(f_{1}+\varepsilon g_{1}, 
    f_{2}+\varepsilon g_{2}, \dots, f_{k}+\varepsilon g_{k}\right)
\]
其中的元素$f_i\in A$从假设生成了理想$I$. 我们现在断言，\emph{存在一个
$A$-模同态$\varphi:I\to A/I$将$f_i$变成了$g_i$当且仅当$\mathscr V
\to \spec K[\varepsilon]/(\varepsilon^2)$是平坦的}（注意到如果$\varphi$
存在，则是唯一的）。从这个断言可以立即得到定理：一个方向上，
如果族$\mathscr X\to \spec K[\varepsilon]/(\varepsilon^2)$是平坦的，
则从唯一性，同态$\varphi$黏起来的得到了层$\mathscr N_{X/Y}$的一个截面。
反过来，如果给定了一个$\mathscr N_{X/Y}$的整体截面，我们可以简单取
$\mathscr X$为局部由理想
\[
    \{f+\varepsilon \cdot \varphi(f): f \in I(V)\}
\]
给出的子概形。

为证明这个断言，首先注意到，一个$K[\varepsilon]/(\varepsilon^2)$-模
$M$是平坦的当且仅当，我们将$K[\varepsilon]/(\varepsilon^2)$-模的
短正合列
\[
    0 \to (\varepsilon) \to  K[\varepsilon] /(\varepsilon^{2})
    \to  K \to  0
\]
张量积上$M$后依然是正和的。将此应用到$\mathscr V$的坐标环
$B=\oo_{\mathscr X}(\mathscr B)$上，我们看到$\mathscr V$在
$\spec K[\varepsilon]/(\varepsilon^2)$平坦当且仅当映射
\[
    (\varepsilon)\otimes B\to B
\]
是单射，即当且仅当，对任何的$f\in A$,
\[
    \varepsilon \cdot f \in I(\mathscr{V}) \Rightarrow f \in I(V).
\]

% p.269

现在假设$f\in A$和$\varepsilon\cdot f\in I(\mathscr V)$. 我们可以记
\[
    \varepsilon \cdot f=\sum(a_{i}+\varepsilon b_{i}) 
    \cdot(f_{i}+\varepsilon g_{i})=\sum a_{i} f_{i}+
    \varepsilon \cdot \sum(a_{i} g_{i}+b_{i} f_{i}).
\]
我们知道右边第一项为零，因为等式的其他两项都可以整除$\varepsilon$.
现在，如果存在一个$A$-模同态$\varphi:I\to A/I$使得$\varphi(f_i)=g_i$，
则我们可以记
\[
    \sum a_{i} \cdot g_{i}=\sum a_{i} \cdot \varphi\left(f_{i}\right)=
    \varphi\left(\sum a_{i} f_{i}\right)=0,
\]
于是将$f_i$变成$g_i$的模同态$\varphi$的存在性可以推出族$\mathscr V$
是平坦的。

反之，假设$\mathscr V\to \spec K[\varepsilon]/(\varepsilon^2)$是平坦的。
则对任意的一组$a_i\in A$使得$\sum a_if_i=0$，我们有
\[
    \varepsilon \cdot \sum a_{i} \cdot g_{i}=\sum a_{i} \cdot (f_{i}
    +\varepsilon g_{i}) \in I(\mathscr{V}) \Longrightarrow 
    \sum a_{i} \cdot g_{i} \in I(V).
\]
因此，我们可以定义一个$A$-模同态$\varphi:I\to A/I$通过将，对任意的
$a_1,\dots,a_k\in A$，$\sum a_if_i\in I$映射到$\sum a_ig_i\in A/I$，
通过上面最后的继续，这是良定的。
\end{proof}

下面是这个定理一个平凡但有用的结果。

\begin{coro}\label{coro:6.30}
Hilbert概形的任意不可约分支$\Sigma$的维数至多为任意概形$X$的法层的
截面空间的维数，其中$[X]\in \Sigma$.
\end{coro}

实际上，这个Hilbert概形的分支的维数的先验估计往往能给出正确答案，特别
当应用到$\mathscr H_P$的分支的一个一般的点$[X]$上时。下面的习题给出了
例子。

\begin{exe}\label{exe:6.31}
    令$\Sigma$是Hilbert概形的一个分支，其一般的元素是$k$个次数为$d$的
    超曲面的完全交$X\subset \P_K^n$. 计算$\mathscr N_X$的整体截面的
    空间的维数，然后证明这等于$\Sigma$的维数。
\end{exe}

\begin{exe}\label{exe:6.32}
    推广上面的习题到Hilbert概形的分支，其一般的元素是次数为$d_1$,
    $\dots$, $d_k$的超曲面的完全交$X\subset \P_K^n$的情况。（这可能
    有点复杂，你可以先考虑$k=2$的情况，这足以知其走向。）
\end{exe}

\begin{exe}\label{exe:6.33}
    令$P(m)$为多项式$3m+1$，而$\Sigma$是$\P_K^3$的子概形的Hilbert概形
    $\mathscr H_P$的分支，其一般的元素为一个扭三次曲线$C$. 证明，
    $\Sigma$的维数为$12$，且它等于$\mathscr N_C$的截面空间的维数。
    \nottran
\end{exe}

% p.270

\nottran

% p.274

\subsection{模空间}\label{s:6.2.4}

类似情形在我们想要构造几何对象的模空间（moduli space）时候也会出现。
比如，我们想要将所有域$K$上的亏格为$g$的非奇异射影曲线的集合等同于
一个“模概形”$\mathscr M_g$的闭点集。为避免非必要的麻烦，我们只考虑
$\operatorname{char}(K)=0$的情况。同样，表达我们想要东西的方式为
引入\emph{亏格为$g$的非奇异曲线的函子}：这个函子
\[
    \mathscr M_g^{\text{fun}}:(\text{$K$-schemes})^\circ \to 
    (\text{sets})
\]
将任意的$K$-概形$B$映到平坦族$\pi:\mathscr X\to B$的集合（模掉所有
$B$-概形的同构$\mathscr X\cong \mathscr X'$），这些
平坦族的纤维为亏格为$g$的非奇异曲线。我们定义$\mathscr M_g$为（任何）
表示了函子$\mathscr M_g^{\text{fun}}$的概形。

因为概形唯一由其点函子确定，上面的“定义”的唯一难点即是否这样的概形存在，
即是否这些函子可表。在$\mathscr H_P$的情况里，答案是肯定的，且实际如
我们指出，$\mathscr H_P$作为表示了函子$h_P$的概形这个刻画对证明存在性
非常重要。

% p.275

然后，在$\mathscr M_g$的情况中，答案是否定的！比如，即使在$\mathbb C$
上的亏格为$1$的非奇异曲线的例子中，也不存在这个意义上的模空间
$\mathscr M_1$. 为看到这点，只需证明不存在一个万有族即可，换句话说，
一个纤维为亏格为$1$的非奇异曲线的平坦族$\pi:\mathscr C\to \mathscr M$
使得对任意纤维为亏格为$1$的非奇异曲线的族$\mathscr Y\to B$，
都存在唯一的态射$\varphi:B\to \mathscr M$
和$\Phi:\mathscr Y\to \mathscr C$构成纤维积的交换图：
\[
    \xymatrix{
        \mathscr Y\ar[r]^\Phi \ar[d]_\eta & \mathscr C\ar[d]^\pi\\
        B \ar[r]^\varphi & \mathscr M
    }
\]
实际上，甚至都不存在一个重言族，即一个态射$\mathscr C\to\mathscr M$
和一个$\mathscr M$的闭点集和亏格为$1$的非奇异曲线的同构类的集合间的
双射，使得$p\in \mathscr M$处的纤维在对应于点$p$的同构类中。我们将
列出万有族的存在性的两类障碍，一个是局部的，一个是整体的。

对局部障碍，回忆$\mathbb C$上的亏格为$1$的曲线由它们的\emph{$j$-不变量}
所分类：我们可以记这样的曲线为平面三次曲线
\[
    y^2=x(x-1)(x-\lambda)
\]
其中复数$\lambda \neq 0,1$，两个这样的曲线$C_\lambda$和$C_{\lambda'}$
是同构的当且仅当$j$-不变量$j(\lambda)$和$j(\lambda')$相等，其中
\[
    j(\lambda)=256\cdot \frac{(\lambda^2-\lambda+1)^3}
    {\lambda^2(\lambda-1)^2};
\]
比如可见Silberman [1986, Chapter III, Proposition 1.7]. 可以证明，
给定一个非奇异基$B$上的亏格为$1$的非奇异曲线族$\mathscr X\to B$，
函数$j$是一个$B$上的正则函数，局部在点$b\in B$附近，$\lambda$也可以
被定义为一个正则函数（即使不唯一）。于是，如果存在一个重言族，则
必须存在一个族其基为坐标%
\footnote{译者注：即$\mathbb A_{\mathbb C}^1$的坐标环为$\mathbb C[j]$.}%
为$j$的仿射直线$\mathbb A_{\mathbb C}^1$.
但是，这样的族并不存在，因为在点$j=0$处，函数$\lambda^2-\lambda+1$
将为零，故$j$将三次为零。没那么显然地，因为$j'(-1)=0$，于是
$j$只能允许取值$1728$时具有偶数重数。（注意到值$j=0$和$1728$对应于
具有“额外自同构”的椭圆曲线，即，其自同构群包含一般的椭圆曲线的自同构群
作为指数%
\footnote{译者注：怕读者忘记（主要是我），指数即陪集的个数。}%
分别为$3$和$2$的子群。）

% p.276 

% p.277 (final page)