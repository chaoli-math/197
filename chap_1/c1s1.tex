就像拓扑或者微分流形是由Euclid空间的开球粘起来的一样，概形是由一类被称为\textit{仿射概形}的开集粘合起来的。但这有一个主要的不同，在流形上，一点局部来看和另一点是相似的，开球也是整个构造需要的唯一开集，它们都是一样的并且非常简单，而概形的局部则更多样。即使是概形中最小的开集也大到许多有趣与不平凡的几何将在这些开集中发生。实际上，在许多概形中，没有两个点有同构的开邻域（除了整个概形）。因此，我们将花费一大部分时间来描述仿射概形。

在这章中，我们将列出一些基本的定义，同时将通过一系列简单的习题来体现与运用这些定义。这章给出的例子大部分是最简单的那种，进而也不一定是那种具有有趣几何的例子。一类更有代表性的例子将在下一章给出，在那里我们意欲指出概形与簇概念的不同，同时给出概形观点所具有的统一的力量的感觉。

\section{仿射概形}

一个\textit{仿射概形}\index{概形!仿射}是一个从交换环构造出的对象。仿射概形与环的联系是仿射簇与其坐标环之间联系的模仿与推广。实际上，我们能以如下方式得到概形的定义。经典代数几何的基本对应是双射
\[
	\{\text{仿射簇}\}\quad \leftrightarrow\quad \{\text{代数闭域$K$上的有限生成无非平凡零因子环}\}
\]

上面对应的左侧是我们感兴趣的朴素几何对象：多项式族的零点集。如果我们说这些是感兴趣的对象，我们将得到右侧受限制的环范畴。当我们改用相反的观点，即我们不再满足于限制“有限生成”、“无非平凡零因子”或者“$K$-代数”，希望右侧包含所有的交换环，此时怎样的几何对象将出现在左侧呢？于是，概形理论出现了，问题的答案是“仿射概形”，在这节中，我们将展示如何拓展上面对应到下图：
\[
\begin{xy}
	\xymatrix{
		\{\text{仿射簇}\}\ar[d]&\ar@{<->}[r]&&\left\{\text{代数闭域$K$上的有限生成无非平凡零因子环}\right\}\ar[d]\\
		\{\text{仿射概形}\}&\ar@{<->}[r]&&\{\text{含幺交换环}\}
	}
\end{xy}
\]

我们会看到，实际上，环与对应的仿射概形是等价对象。概形是许多几何命题更自然的背景，概形的语言将允许我们在下面的章节中一般化我们的构造。

\nottran

令$R$是一个交换环。$R$所定义的仿射概形将被记作$\spec R$，称为环$R$的\idx{谱}. \nottran

\subsection{作为集合的概形}

我们定义$\spec R$中的一个点是$R$的一个素理想。为了避免符号混用，我们通常以$[\pp]$来记$\spec R$中对应于素理想$\pp$的点。按照一般习惯，我们将认为$R$本身不是一个素理想。当然，如果$R$是一个整环，则$(0)$理想是素理想。

如果$R$是一个寻常的代数闭域上的仿射概形$V$的坐标环，$\spec R$中的对应于$R$的极大理想的点将对应于仿射概形中的点，同时对$V$的每个不可约子簇，$\spec R$中还将对应有一点。这些新添的点，对应于正维数的子概形，虽然一开始会让人心神不安但后来就变得方便起来，它们将担当经典代数几何中“一般点”的角色。

\begin{exe}
确定$\spec R$，当$R$是~~~~(a) $\zz$;~~~~(b) $\zz/(3)$;~~~~(c) $\zz/(6)$;~~~~(d) $\zz_{(3)}$;~~~~(e) $\cc[x]$;~~~~(f) $\cc[x]/(x^2)$.
\end{exe}

每一个$R$中的元素$f$都将在$X=\spec R$上定义一个“函数”，我们依然记作$f$：对$x=[\pp]\in \spec R$，我们记$\kappa(x)$或者$\kappa(\pp)$为整环$R/\pp$的商域，称为$X$在点$x$处的剩余类域，同时典范映射
\[
	R\to R/\pp\to \kappa(x)
\]
下$f$在$\kappa(x)$中的像，我们定义为$f(x)$.

\begin{exe}
	“函数”$15$在点$(7)\in \spec \zz$的值是什么？在点$(5)$处呢？
\end{exe}

\begin{exe}
	\begin{enumerate}[{(a)}]\setlength{\itemsep}{0pt}
		\item 考虑多项式环$\cc[x]$，令$p(x)$是一个多项式。证明，若$\alpha\in\cc$是一个数，则$(x-\alpha)$是一个$\cc[x]$的素理想，并且，存在$\kappa((x-a))$与$\cc$的自然等同，使得点$(x-\alpha)\in\spec\cc[x]$处的值$p(x)$就是数$p(\alpha)$.
		\item 更一般地，如果$R$是一个代数闭域上的仿射簇$V$的坐标环，$\pp$是一般意义上对应于点$x\in V$的极大理想，则$\kappa(x)=K$以及$f(x)$就是一般意义上函数$f$在点$x$处的值。
	\end{enumerate}
\end{exe}

一般地，“函数”$f$取值的域逐点不同。此外，$f$也没必要由在其“函数”每一点的值决定。比如，如果$K$是一个域，环$R=K[x]/(x^2)$只有一个素理想$(x)$，于是对应元素$x\in R$，虽然是非零的，但诱导了一个“函数”在$\spec R$上处处为零。

我们直接将$\spec R$上的“正则函数”定义为$R$的一个元素。于是一个正则函数给出了$\spec R$上的一个“函数”，但他并不由这个“函数”的值决定。

\subsection{作为拓扑空间的概形}

通过正则函数，我们可以将$\spec$修饰成一个拓扑空间，这个拓扑被称为\textit{Zariski拓扑}. 闭集定义如下，对$R$的任意子集$S$，令
\[
	V(S)=\{x\in \spec R\,|\, f(x)=0 \text{对每一个} f\in S\text{都成立}\}=\{[\pp]\in\spec R\,|\, \pp\supset S\}.
\]

这个定义的动机是使得每个$f\in R$都表现得尽可能像一个连续函数。当然，域$\kappa(x)$没有拓扑，因为它逐点变化让一般意义上的连续无从谈起。但至少，它们都包含了一个零元，于是我们就可以谈$f\in R$在$\spec R$上的零点集，如果$f$像一个连续函数，则零点集应该是一个闭集。因为闭集族相交必须是闭集，我们立即得到了上述定义：$V(S)$就是$S$中所有元素的零点集的交。

为使得所有$V(S)$是闭集，它们的任意交也必须在该族里面。从上面的描述很清楚，对一族集合$S_a$，我们有$\bigcap_a V(S_a)=V(\bigcup_a S_a)$，这正是需要的。此外，如果$I$是$S$生成的理想，则$V(I)=V(S)$.

Zariski拓扑中的一个开集即一个$V(S)$的补。只有一个元素的集合$S$对应的开集有着特殊的地位，本质上是因为它们依旧是某个环的谱。由这个原因，我们有一个特殊的名字与记号。设$f\in R$，定义关联于$f$的\textit{distinguished}\footnote{译者注：这里的英文是`distinguished'，日文wiki翻译为“識别可能的”，但如果翻译成“可识别的”似乎不太合适，所以后面正文中出现的`distinguished open set'都当作`basic open set'翻译。}（或者\textit{基本}）开集为
\[
	X_f=|\spec R|\setminus V(f).
\]

$X_f$的点是$R$中不包含$f$的素理想，其一一对应于$R$添上$f$的逆的局部化$R_f$的素理想，对应关系为$\pp\subset R$到$\pp R_f\subset R_f$. 因此，我们能等同$X_f$与$\spec \rr_f$中的点，我们将在本书的剩余部分默认这个等同。

基本开集构成了Zariski拓扑的一组\textit{拓扑基}，实际上，任意的开集都是一族基本开集的并：
\[
	U=\spec R\setminus V(S)=\spec R\setminus\bigcap_{f\in S}V(f)=\bigcup_{f\in S}(\spec R)_f.
\]

基本开集的有限交也还是基本开集，因为一个素理想包含一个乘积当且经当它包含其中一个因子，对$g=f_1\cdots f_n$，我们有
\[
	\bigcap_{i=1}^n (\spec R)_{f_i}= (\spec R)_{g}.
\]
特别地，基本开集如果是某个基本开集$(\spec R)_f$的子集，则它具有形式$(\spec R)_{fg}$.

$\spec R$几乎不会是一个Hausdorff空间，它的开集太大了。实际上，$\spec R$中只有对应于极大理想的点才是闭的。一般地，很清楚，包含给定点$[\pp]$的最小闭集必须是$V(\pp)$，于是$[\pp]$的闭包包含所有的$[\mathfrak{q}]$使得$\mathfrak{q}\supset\pp$. 因此点$[\pp]$是闭集当且仅当$\pp$是极大的。于是当$R$是代数闭域上的代数簇$V$的坐标环时，$V$的点一一对应着$\spec R$的闭点，以及对应于点$[\pp]$的闭包中的点就是$V$中由$\pp$确定的子簇的点。

\begin{exe}
	\begin{enumerate}[{(a)}]\setlength{\itemsep}{0pt}
		\item $\spec \cc[x]$中的点是素理想$(x-a)$与$(0)$，其中$a\in\cc$. 描述它的拓扑。哪些点是闭的？闭点中是否有一个开的？
		\item 令$K$是一个域，而$R$是局部环$K[x]_{(x)}$. 描述拓扑空间$\spec R$. （这个的答案将在本节后面给出。）
	\end{enumerate}
\end{exe}

为了完成$\spec R$的定义，我们必须描述\textit{结构层}或者说$X$上的\textit{正则函数层}。在做这个之前，我们将暂时离开主线给出一些层理论的基本定义以及证明一个以后必须的命题（Proposition \ref{pro:1.1.12}）。

\subsection{插曲：层理论}

令$X$是任意拓扑空间。$X$上的一个\textit{预层}$\mathscr{F}$是对每一个$X$中的开集$U$都附上一个集合，记作$\mathscr{F}(U)$, 以及对每一列开集$U\subset V\subset X$，有一个\textit{限制映射}
\[
	\res_{V,U}:\ff(V)\to \ff(U)
\]
满足
\[
	\res_{U,U}=\mathrm{identity}
\]
以及对所有$U\subset V\subset W\subset X$
\[
	\res_{V,U}\circ \res_{W,V}=\res_{W,U}.
\]
$\ff(U)$中的元素被称为\textit{$\ff$在$U$上的截面}，$\ff(X)$中的元素被称为\textit{整体截面}。

表述这个定义的另一种方式是将\textit{预层}定义为一个$X$上的开集范畴（对每一个包含$U\subset V$有一个态射$U\to V$）到集合范畴的反变函子。改变目标范畴到交换群范畴，我们就得到了交换群预层，类似地，可以将目标范畴改成环、代数等。

这类构造中最重要的是在拓扑空间$X$上的一个环预层$\oo$上的\textit{模预层}$\ff$. 这样一个东西包含一对
\begin{quote}
对每一个$X$的开集$U$，都有一个环$\oo(U)$以及一个$\oo(U)$-模$\ff(U)$
\end{quote}
以及
\begin{quote}
任取包含$U\supset V$，有一个环同态$\alpha:\oo(U)\to\oo(V)$，通过$\alpha$将$\ff(V)$看成$\oo(U)$-模，还应有一个$\oo(U)$-模同态$\ff(U)\to\ff(V)$.
\end{quote}

一个（集合、交换群、环、模等）预层如果他还满足被称为\textit{层公理}的一些新条件时，它被称为一个\textit{层}。这个条件是，对每一个$U\subset X$的开覆盖$U=\bigcup_{a\in A}U_a$，以及任意一族
\[
	f_a\in \ff(U_a)\quad \text{对每一个}a\in A
\]
如果满足，任取$a$, $b\in A$，如果$f_a$与$f_b$限制到$U_a\cap U_b$相同，则存在唯一的元素$f\in \ff(U)$使得其限制在$U_a$上就是$f_a$对每一个$a$都成立。

这里有一个平凡但时常引起混乱的点值得一提。空集$\varnothing$当然是$\spec R$的一个开集，他也能被写作一个空族的并（即，上一段中的指标集$A$是一个空集）。因此，层公理告诉我们，任意的层都有且只有一个开集上的截面。特别地，对一个环层$\ff$，$\ff(\varnothing)$是零环（即$0=1$的环）。注意到零环没有素理想，如果承认选择公理，这也是唯一不含素理想的一个含幺环，于是它的谱是$\varnothing$.

\begin{exe}
	\begin{enumerate}[{(a)}]\setlength{\itemsep}{0pt}
		\item 令$X$是一个二元素集$\{0,1\}$，
	\end{enumerate}
\end{exe}

\begin{pro} \label{pro:1.1.12}
	令$\mathscr{B}$是$X$的一个开集基。
	\begin{itemize}\setlength{\itemsep}{0pt}
		\item[{\rm (i)}] 每个$\mathscr{B}$-层都可以唯一拓展为$X$上的一个层。
		\item[{\rm (ii)}] 给定$X$上的层$\mathscr{F}$域$\mathscr{G}$，以及对每一个$U\in \mathscr{B}$有映射
		\[
		\tilde{\varphi}(U):\mathscr{F}(U)\to \mathscr{G}(U),
		\]
		这族映射与限制映射可交换，则存在唯一的层态射$\varphi:\mathscr{F}\to \mathscr{G}$使得$\varphi(U)=\tilde{\varphi}(U)$对每一个$U\in \mathscr{B}$都成立。
	\end{itemize}
\end{pro}

\proof 对每一个$X$的开集$U$，\nottran \qed
